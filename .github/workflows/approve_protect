name: Block Approval if Checkboxes are Unchecked

on:
  pull_request_review:
    types: [submitted]

jobs:
  validate-checkboxes:
    runs-on: ubuntu-latest

    steps:
    - name: Check PR description for unchecked checkboxes
      uses: actions/github-script@v6
      with:
        script: |
          const prBody = context.payload.pull_request.body;
          const unchecked = prBody.match(/- \[ \]/g); // Unchecked checkboxes
          if (unchecked) {
            core.setFailed(`PR cannot be approved because there are unchecked checkboxes: ${unchecked.length}`);
          }
